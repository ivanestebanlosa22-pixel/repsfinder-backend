// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // Asegúrate de que el URL esté en tu archivo .env
}

model Store {
  id              Int              @id @default(autoincrement())
  name            String
  alias           String?          // Alias opcional
  platform        String           // Weidian, Taobao, etc.
  url             String
  category        Category         @relation(fields: [categoryId], references: [id])
  categoryId      Int
  priceTier       PriceTier        // Rango de precios: Low, Medium, High
  activityStatus  ActivityStatus   // Estado: activo, inactivo
  reputationScore Float            // Puntaje basado en señales de reputación
  lastCheckedAt   DateTime         @default(now())  // Fecha de la última revisión
  signals         ReputationSignal[]

  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
}

model ReputationSignal {
  id              Int      @id @default(autoincrement())
  storeId         Int
  sourceType      String   // Reddit, QC, Forum, etc.
  sourceUrl       String
  sourceDate      DateTime @default(now())
  signalKind      String   // Positiva, negativa, mixta, etc.
  evidence        String?  // Descripción o evidencia (por ejemplo, "foto QC")
  store           Store    @relation(fields: [storeId], references: [id])

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Category {
  id    Int     @id @default(autoincrement())
  name  String
  stores Store[]
}

enum PriceTier {
  LOW
  MEDIUM
  HIGH
}

enum ActivityStatus {
  ACTIVE
  INACTIVE
  UNKNOWN
}
